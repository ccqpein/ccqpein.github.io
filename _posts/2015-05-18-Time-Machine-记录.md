---
layout:     post
title:      "Time Machine 记录"
modified:   2015-05-18
tag: mass
---


## 写在前面

由于前段时间手残，把Mac 搞得风生水起，结果恢复了半天（这里奔跑着歌颂unix的权限设置和用户单独一个目录的设置）。虽然我有文档备份，但是安装的环境，配置，各种不在图形界面的历史纪录，app的缓存和用户设置这些都没有也很难备份，为了防止下次手残导致不可逆的悲剧，不得不立刻准备Time Machine了。

这一篇属于纪录，随时会增补。

## 什么是Time Machine

略

## 纪录：格式化新硬盘

OS X格式化新磁盘的时候，选择分区，在选项（option）里面会有选择分区格式，分为三种分区格式：

* GUID分区（建议选择）
* Apple分区
* 主引导纪录（master boot record）

后面会有说明，简单来说，第二种是powerPC 的Mac 用的，第三种是可用于驱动DOS Windows电脑。

这里要说一下，这一步比较坑，原因在于，可能是为了能和windows和平共处（诛心），默认硬盘分区格式会选择第三种，另外这个设置在分区的选项里面，埋的挺深，而且是第一步，不能更改，等反应过来的时候，不得不重新设置分区（换句话说，格式化整个硬盘），资料备份又是大工程，300G的资料，USB3.0，70MB/s的速度也得一小时左右，来回两小时花掉了。

## 记录：设置文件系统

在设定分区的时候就会有选择文件系统的选项，这个不像分区选项这么坑，选择能用的就好了。

这一步选择文件系统和之前的分区格式没有关系，亲测无论是GUID分区还是主引导分区，都不会干扰文件系统的选择。

## 纪录：Time Machine备份

准备好硬盘后，Time Machine的设置就比较傻瓜化了，用过Time Machine的说，第一次备份很慢，后面就很快了，查了一下，Time Machine用的是Mac自己的FSEvent服务，会自动搜索变更的文件，然后进行增量备份，没有更改的就不会重新备份。

这里有一个小坑，但是我没有测试过是不是这样，如果使用了自建数据库的app，比如photo，iMovie，以及：**把我从手残中挽救回来的德意志帝国炸裂文档管理app——devonthink**，这些App会自建一个数据库，好处显而易见：换电脑或者共享数据时，一个数据库扔过去，全部文档都在里面了。

但是在Time Machine的情景下，数据库的任何变动都会激活FSEvent，然后Time Machine会把数据库当作一个文件，不停的重新备份，非常残暴。

对于这种软件，就需要在Time Machine的设置里面忽略，让Time Machine不要备份数据库，然后可以通过云同步，或者app自带的同步，或者手动备份。由于自设数据库，全部备份只需要复制粘贴。这并不与我使用Time Machine的初衷相违背，我用Time Machine主要就是备份无法手动顺利备份的文件。

## 纪录：Time Machine加密

在选择Time Machine备份盘的时候有一个加密选项，这个选项可能是不能选的，比如我一开始就是这样，原因就是因为加密只支持GUID分区格式，而默认值并不是。

一开始我觉得不加密没什么，第一次备份完发现，整个系统的文件都在里面，不加密的话，相当于暴露了一整个系统。

加密只有一个问题，这时候如果之前分区不是GUID分区，那么只能重新格式化硬盘，才能加密。并且不光是Time Machine加密，普通的加密也必须要求外接硬盘是GUID分区。
