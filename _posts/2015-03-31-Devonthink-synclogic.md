---
layout:     post
title:      "Devonthink同步逻辑"
modified:   2015-03-31
feature:   ""
tag: App
---

今天归档部分文档的时候发现devonthink的同步逻辑和平时的一些软件不太一样，例如iTunes，dropbox都是无论你在哪里更改，同步后另一端的人文件都会变成更改后的文件。
举个例子，我在iPhone上删除了播放列表里面的一首歌，同步后，iTunes Mac端同名的播放列表会删除同一首歌。同理，在dropbox的Mac端删除一个文件，同步后，服务器端会记录你的变化，然后删除这个文件，再然后你的手机同步，这个文件也会删除，这个sync的概念大概就是这样。

但是，devonthink有点不同。

devonthink在设置界面允许把数据库和别的文档位置同步，我选用的是同步到外置硬盘，同步的数据库后缀比一般的库多了「sync」，我的情景如下：

- 本地有一个库local\_1，和硬盘端remote_1同步
- 我本地新加了一个库local\_2，想废弃local_1。
- 准备同步local\_2覆盖到remote_1。

这个时候我取消了local_1对remote_1的同步，然后再点同步，这时候移动硬盘上的数据并没有出现变动，仔细想一下，这个逻辑很正常。

当我把local\_2勾选了和remote_1同步的时候，我的本意是用local\_2覆盖掉原来的remote\_1，结果失败了，点到remote\_1里面看了一下，有两个文件夹，从大小来看一个是local\_1，一个是local\_2，也就是说：**同步端属于一个增量备份，并且可以不同的数据库同步到一个地方。**

取消同步并不能把同步库的文档删除，哪怕本地库删除了，同步库中依旧会存有文件。

这样就可以理解软件设置中的同步提示：

>sync this database …at these times …with these locations

同步的库能备份很多库，但是取消同步后，原来的库还在里面。如果不是这样，无法做到很多库同步到一个地方，不能删除，只能更改。如果想删除一个库，不能直接删除，只能清空后同步，如果直接删除了本地库，同步库里面有之前文件的备份。

－－－－－－－－－20150331更新－－－－－－－

前段时间把硬盘里的教程全部移植到外接硬盘，然后在devonthink 做了个index ，本地的库容量没有变化，更改文件名后，外置硬盘的文件也更改了，index的挺彻底。

sync的时候，外部的同步库容量暴增，看了一下，同步的时候外部的库里面包括了索引的源文件，也就是说：

- 我外置硬盘的视频index到devon里面
- 然后devon同步的时候，往外部硬盘库里面同步复制了视频源文件

结果就是，外置硬盘里面理论上是有两个一摸一样的教程视频的，不过还好本地的文件没有变化，等外置快满了再想办法解决吧。