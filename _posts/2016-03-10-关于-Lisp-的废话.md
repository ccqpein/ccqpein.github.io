---
layout: post
title: 关于 Lisp 的废话
modified: 2016-3-10
tags: study
image:
---

## 起源

Lisp 诞生了至少半个世纪了，至于为什么学这门语言，老实说是收到了Paul Graham 的安利。他在《黑客与画家》这本书里面，对Lisp 的评价非常高。在中文网络上面搜索，对Lisp 最坏的评价也只是停留在「装逼」上，而这是对人的评价，并且是一个中文网络环境中较为无聊的评价，相比PHP 和 Java，针对语言本身的争论并没有这么大。当然也可能是学的人太少，即使已经有几本不错的中文教材和优秀的博文，Lisp 诡异的语法就吓退了不少人。

在2014年底知道了Emacs 这个编辑器，而Emacs 自带一个 Lisp 方言。当在一段时间经常性的看到一个单词，而且伴随「黑魔法」「神的编辑器」这种迷魂汤一起出现，即使是我，恐怕也沦陷了。

## 上车

我先了解了一下 Lisp 的现状，Lisp 有众多的方言，主要还在活跃的是这三个：Scheme，Clojure，和 Common Lisp。第一个 Scheme 是 MIT 自己用来讲课的语言（[SICP](http://www.wikiwand.com/en/Structure_and_Interpretation_of_Computer_Programs)）。Clojure 最近才看了一点，个人感觉是 Lisp 和 Java 的混合体，由于科班出身的大部分在学校都学了 Java，用 Clojure 做项目应该更好上手一点。

前面关于 Scheme，Clojure 的评价都是后话，我最开始是想从 Emacs 开始，根据[这篇](http://blog.csdn.net/redguardtoo/article/details/7222501)教程所讲，最好的开始方法是直接拿高手的配置，尝试了一下，后来由于两个原因，放弃这个方法：

+ 我个人不太喜欢预装一大堆语言的环境，这种赘余不能忍
+ 背景色太丑

于是打算开始看 Emacs 自己的 ELisp 来自己配环境。中文资料太少，后来发现 Emacs 自己的手册写的已经很好了，但是按照之前的经验，看完手册不写东西，和没看没什么两样。几乎是同一时间，看的Common Lisp 教程里面有教如何用 `sbcl`和`Slime` 来把 Emacs 变成一个Ide，类似于`IPython`，而且比较简单。于是就把 ELisp 先放到一边，从Common Lisp 开始。


## 关于CL和其它

之所以选择了 Common Lisp 一个原因是上面讲的，在当时上手相对方便，另一个原因是之前了解了一点 Lisp 方言的情况， Common Lisp 更接近纯 Lisp，想一开始学个比较通用型的。

Lisp 诡异的语法来源 [S-expression](http://www.wikiwand.com/en/S-expression) 至于与 Church 的 lambda 表达式有的关系，我没查，只是觉得长得像。而 lambda 表达式被作为用于证明可计算性，而图灵证明「可计算」的问题就是图灵机能计算的问题，并且图灵证明了 Church 证明的可计算性和图灵证明的是同一个东西，某种程度上 lambda 表达式就是形式上的图灵机，演变成一个高级语言是顺理成章的。


## 难度

Lisp 的诡异语法在网络上出了名，看习惯了其实并没有这么难，相反，现在觉得 Lisp 的语法相当简单，括号的第一个元素永远是函数（操作符），然后后面都是参数。代码成块状组织，一个函数是一个块，一个文件是一个块，也可以做成一个包，然后只导出特定的符号。包的概念和一些较新的编程语言一样，符号的概念和`quote`互指，在之前写的语法糖总结里面有用法，就不再写了。

块的概念自然延伸出闭包，环境变量等特性，这点几乎所有主流的编程语言都能做到，Lisp 在这方面的优点不是因为它做的比别人更好，而是因为它用了固定单调的语法逻辑，延伸构造出了这些功能，逻辑从头到尾都是统一的，某种意义上讲，更容易理解（我想这就是 MIT 为什么用 Lisp 来做编程教学语言）。

>从现在开始，后面所有的实现都只针对 Common Lisp（简称CL）如果穿插了别的语言，会另外声明。

CL 中的数据结构就没有语法上这么泾渭分明，只是写的时候坑多一点，多看文档也没有这么难。举个例子，`length`这个函数文档里是这么定义的`length sequence => n`，但是sequence 这个数据类型至少包含了字符串、向量和列表，换个概念就是，这个sequence 是所有「序列」的超类，这个函数针对的是一个抽象概念，针对一类的方法。这种方法应该还有很多，我这里就不去查文档了。

除了自有函数以外，宏是各个书和教程最为津津乐道的功能之一，但是有意思的是，都知道Lisp 的宏是个神奇的设计，但每个人都写不多字，只能靠代码示例来凑字数。我想可能因为这个功能是Lisp 设计过程中自然而然一定会产生的高纬用法，神奇、强大又理所当然。

简而言之，宏是用来写代码的代码，宏求值后的代码，将被第二次求值。如果你逻辑够好，我相信可以像套娃一样，一层一层写出去。

CL 里面已经有很多固有函数，加上一些固有宏，数量相当惊人，这也是我认为最难的地方。不像语法、逻辑、类这种记住了就很难忘的东西，函数只能靠多写和 Google 来记忆，CL 自己也注意到这一点，所以有一些特定的命名规则，但是杯水车薪。同时 Lisp 设计有着超高的自由度，有时候一个实现有好几种解决方法，中文资料又少，绝对是个练习快速英文论坛阅读的好途径。

## 乐趣

终于写到这部分了，对我而言 Lisp 的乐趣就在于设计代码，自由度高到几乎想干什么干什么的地步。正因如此脑袋清楚是非常重要的，有时候写一半想到更好的解决办法，只能全部删掉重来。

比如我要迭代，`do`、`loop`都可以同时迭代多个变量。再比如我要遍历列表，`dolist`、`loop`、`do`都可以。即使只有一个`do`，是把代码写到判断框，还是写到判断外都是要考虑的事情。

由于 Lisp 够老，可以通过它一一对应到别的语言和操作系统的概念，非常有意思。

## 该不该学？

虽然我个人很喜欢 Lisp，但是不可否然用它开发确实快不起来，取决于你是打算用别的语言铺一块木板先过河，还是建一座用很久很久大桥。